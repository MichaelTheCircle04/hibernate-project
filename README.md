# hibernate-project
### Цели:
- Углубить понимание фреймворка Hibernate, в частности:
  - FetchType
  - Поработать с вложенными коллекциями (Brand -> содержит коллецкию Model, Model -> содержит коллецкию Car)
- Получить дополнительный опыт работы с Spring HATEOAS
- Потренироваться в использовании Flyway

### Технологии: 
- Spring Boot
- Spring HATEOAS
- Hibernate
- Flyway
- H2 (тесты) + PostgreSQL (основная)
- Hamcrest (для тестирования)

### Важно:
Проект состоит из множества неоптимальных решений, по причине того, что он задумывался в первую очередь как тренажер,
поэтому во множестве мест я специально создавал себе сложности и искал пути их решения. Основная моя цель была изучить
разные способы взаимодействия с Hibernate напрямую (без Spring Data Jpa), а также (по большей части в целях собственного развлечения) 
попробовать произвести базовую автоматизацию некоторых операций (подготовки строки запроса и его выполнения), т.е. я писал 
в ручную различные операции с базой, а потом думал как сократить повторяющийся код.

### Конецепция:
Есть какой-то фронт, логику его работы я не продумывал, но на нем должны быть страницы типа: все автомобили, все модели, все марки.
Помимо этого должна быть строка поиска и фильтры (например модели, марки, цены). Поиск осущевляется на основе введенной строки и 
выбраных фильтров. Если строки нет, то только фильтров. Также важно отметить, что в моей голове фильтры работают 
так: пользователь выбирает марку или несколько, а потом ему становится доступен выбор моделей из этих марки, но после отметки моделей поиск
осущуствляется ТОЛЬКО ПО НИМ, т.е. выбрать допустим Lada и Toyota, потом в моделях указать Camry и ожидать что среди Тойот будет выбрана только
Camry, а Лады будут все НЕЛЬЗЯ. Я думал реализовать это, но пришел к выводу для этого нужно значительно усложнить код, а практической пользы
в этои мало. Кроме того, конечно, расширять фильтры можно до бесконечности, но в данном случае, так как это учебный проект, все максимально
упрощено. Помимо вышеуказанных страниц должны быть страницы отдельных автомобилей, моделей и марок, которые содержут ссылки на связанные старницы, 
которые теоретически могут понобиться пользователю. Также я написал некоторую часть архитектуры необходимой для операций изменения, но методов
endpoint'ы для изменения в данный момент не написаны. 
    
### Компоненты системы:
- DTO-шки
- ***ModelAssembler'ы - создают RepresentationModel'и и добавляют в них необходимые ссылки
- SqlPreporator'ы и Customizer'ы - так как я столкнулся с необходимостью писать ряд однотипных запросов, 
мне пришло в голову создать примитивный DSL для их написания, типа JOOQ. Разумеется это очень упрощенный вариант который 
подходит только для конкретно моего случая, но так как я сознательно решил ограничить используемые технолигии доступа к базе одним Hibernate'ом,
то написать что-то подобное мне показалось логичным (не осуждайте меня, мне было весело :3) 
- ReferenceController - принимает запросы с id-шниками, т.е. когда пользователь переходит по ссылкам созданным ассемблером 
- UserSearchController - принимает запросы со словами которые пользователь вводит в строку поиска
- CarService - создает нужные SqlPreporator'ы и передает их в репозитии
- SearchService - делает концептуально то же самое, что и CarService, но испрользуется когда нужно осуществлять поиск по строке введенной пользователем
- AbstractRepository - содержит базовый функционал общий для всех репозиториев:
  - метод obtainResult позволяет на основе аргументов подготовить и выполнить базовый запрос и получить списко найденных объектов
  - метод executeQuery позволяет выполнить запрос на изменение без получение результата
